version: 2

models:
  - name: silver_flights
    description: >
      Cleaned and normalised flight records. Incrementally updated from
      bronze_flight_prices. Enriched with French city/country names from
      ref_airports. Used as the base for gold_route_stats and gold_deals.
    columns:
      - name: flight_hash
        description: MD5 dedup key (inherited from bronze)
        tests:
          - not_null
          - unique
      - name: origin_iata
        description: Origin IATA code (uppercase, validated)
        tests:
          - not_null
      - name: dest_iata
        description: Destination IATA code (uppercase, validated)
        tests:
          - not_null
      - name: departure_at
        description: UTC departure datetime
        tests:
          - not_null
      - name: return_at
        description: UTC return datetime
        tests:
          - not_null
      - name: duration_h
        description: Trip duration in hours (departure -> return)
        tests:
          - not_null
          - dbt_utils.accepted_range:
              arguments:
                min_value: 12
                max_value: 744
      - name: price_eur
        description: Total round-trip price in EUR
        tests:
          - not_null
          - dbt_utils.accepted_range:
              arguments:
                min_value: 1
                max_value: 1999
      - name: is_direct
        description: True if outbound leg is direct (no stops). NULL for data sources that don't provide stop info.
      - name: dest_popularity_tier
        tests:
          - not_null
          - accepted_values:
              arguments:
                values: [0, 1, 2, 3]

  - name: silver_hostels
    description: >
      Cleaned hostel price records from bronze_hostel_prices (Hostelworld).
      One row per (hostel_id, checkin, checkout) combination.
    columns:
      - name: hostel_id
        tests: [not_null]
      - name: dest_iata
        tests: [not_null]
      - name: price_per_night_eur
        tests:
          - not_null
          - dbt_utils.accepted_range:
              arguments:
                min_value: 1
                max_value: 200
      - name: nights
        tests:
          - not_null
          - dbt_utils.accepted_range:
              arguments:
                min_value: 1
                max_value: 30
      - name: rating
        tests:
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0
                max_value: 100
